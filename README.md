# ì›í‹°ë“œ í”„ë¦¬ì˜¨ë³´ë”© ì¸í„´ì‹­ í”„ë¡ íŠ¸ì—”ë“œ - 3ì£¼ì°¨ ê³¼ì œ

ì›í‹°ë“œ í”„ë¦¬ì˜¨ë³´ë”© ì¸í„´ì‹­ í”„ë¡ ë“œì—”ë“œì—ì„œ 3ì£¼ì°¨ ê³¼ì œë¡œ ì§„í–‰í•œ  
**[í•œêµ­ì„ìƒì •ë³´](https://clinicaltrialskorea.com/)ì˜ ê²€ìƒ‰ ë° ìºì‹± ê¸°ëŠ¥ì„ í´ë¡  êµ¬í˜„**í•˜ì—¬ ì›¹ì‚¬ì´íŠ¸ë¥¼ êµ¬ì¶•í•˜ëŠ” í”„ë¡œì íŠ¸ ì…ë‹ˆë‹¤ :)

## ê°œë°œ í™˜ê²½

### Developement

<img src="https://img.shields.io/badge/Node.js v18 (LTS)-grey?style=for-the-badge&logo=nodedotjs"> <img src="https://img.shields.io/badge/React-61DAFB?style=for-the-badge&logo=React&logoColor=white"/> <img src="https://img.shields.io/badge/TypeScript-3178C6?style=for-the-badge&logo=TypeScript&logoColor=white"/>

### Convention

<img src="https://img.shields.io/badge/husky-brown?style=for-the-badge&logo=npm"> <img src="https://img.shields.io/badge/lint staged-white?style=for-the-badge&logo=npm"> <img src="https://img.shields.io/badge/ESLint-4B32C3?style=for-the-badge&logo=eslint"> <img src="https://img.shields.io/badge/Prettier-F7B93E?style=for-the-badge&logo=prettier&logoColor=white">

### Network & Route

<img src="https://img.shields.io/badge/React Router-CA4245?style=for-the-badge&logo=React Router&logoColor=white"> <img src="https://img.shields.io/badge/Axios-5A29E4?style=for-the-badge&logo=Axios&logoColor=white"/>

### Styling

<img src="https://img.shields.io/badge/styled component-DB7093?style=for-the-badge&logo=styled-components&logoColor=white"/>

## í”„ë¡œì íŠ¸ ì‹¤í–‰ ë°©ë²•

1. ë°±ì—”ë“œ ì„œë²„ ì‹¤í–‰ ( !í•„ìˆ˜! )

   - [ì—¬ê¸°](https://github.com/walking-sunset/assignment-api)ì— ë“¤ì–´ê°€ì„œ ìš°ì¸¡ ìƒë‹¨ì˜ `Code`ë²„íŠ¼ -> `Download ZIP`ì„ ëˆŒëŸ¬ í”„ë¡œì íŠ¸ë¥¼ ë‹¤ìš´ë¡œë“œ í•˜ì‹œê±°ë‚˜,  
     ì•„ë˜ì˜ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•´ í”„ë¡œì íŠ¸ë¥¼ clone í•´ì£¼ì„¸ìš”.
     ```
     git clone https://github.com/walking-sunset/assignment-api.git
     ```
   - í”„ë¡œì íŠ¸ ë‹¤ìš´ë¡œë“œê°€ ëë‚¬ë‹¤ë©´, í•´ë‹¹ ë””ë ‰í† ë¦¬ë¡œ ì´ë™í•´ í”„ë¡œì íŠ¸ì— í•„ìš”í•œ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•´ì£¼ì„¸ìš”.
     ```
     npm install
     ```
   - íŒ¨í‚¤ì§€ ì„¤ì¹˜ê°€ ëë‚¬ë‹¤ë©´, ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•´ ë°±ì—”ë“œ ì„œë²„ë¥¼ ì‹¤í–‰ì‹œì¼œì£¼ì„¸ìš” !
     ```
     npm start
     ```

2. í”„ë¡ íŠ¸ ì„œë²„ ì‹¤í–‰
   - ìš°ì¸¡ ìƒë‹¨ì˜ `Code`ë²„íŠ¼ -> `Download ZIP`ì„ ëˆŒëŸ¬ í”„ë¡œì íŠ¸ë¥¼ ë‹¤ìš´ë¡œë“œ í•˜ì‹œê±°ë‚˜,
     ì•„ë˜ì˜ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•´ í”„ë¡œì íŠ¸ë¥¼ clone í•´ì£¼ì„¸ìš”.
     ```
     npm clone https://github.com/wisdomin121/wanted-pre-onboarding-frontend-3.git
     ```
   - í”„ë¡œì íŠ¸ ë‹¤ìš´ë¡œë“œê°€ ëë‚¬ë‹¤ë©´, í•´ë‹¹ ë””ë ‰í† ë¦¬ë¡œ ì´ë™í•´ í”„ë¡œì íŠ¸ì— í•„ìš”í•œ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•´ì£¼ì„¸ìš”.
     ```
     npm install
     ```
   - íŒ¨í‚¤ì§€ ì„¤ì¹˜ê°€ ëë‚¬ë‹¤ë©´, ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•´ ë°±ì—”ë“œ ì„œë²„ë¥¼ ì‹¤í–‰ì‹œì¼œì£¼ì„¸ìš” !
     ```
     npm start
     ```
3. ì…ë ¥ ë°©ë²•
   - inputì„ í´ë¦­í•˜ì—¬ ì›í•˜ëŠ” í‚¤ì›Œë“œë¥¼ ì‘ì„±í•œë‹¤.
   - input ì•ˆì— ìˆëŠ” ë‹ë³´ê¸° ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ 'ìµœê·¼ ê²€ìƒ‰ì–´'ë¡œ ì§€ì •ëœë‹¤. ( ì—”í„° ë¶ˆê°€ëŠ¥ )
   - ë°©í–¥í‚¤(â†‘, â†“)ë¥¼ í†µí•´ ê²°ê³¼ê°’ì„ ì›€ì§ì¼ ìˆ˜ ìˆìœ¼ë©°, ì—”í„°ë¥¼ ëˆ„ë¥´ë©´ í•´ë‹¹í•˜ëŠ” textê°€ inputì˜ valueë¡œ ì§€ì •ëœë‹¤.
   - escë¥¼ ëˆ„ë¥´ë©´ ê²°ê³¼ì°½ì´ ë‹«íŒë‹¤.

## ë°°í¬ ë§í¬ ë° ë°ëª¨ ì˜ìƒ

ë°°í¬ëŠ” `Vercel`ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤ :)  
https://wanted-pre-onboarding-frontend-3.vercel.app/

## ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
ğŸ“¦src
 â”£ ğŸ“‚apis
 â”£ ğŸ“‚assets
 â”£ ğŸ“‚components
 â”£ ğŸ“‚hooks
 â”£ ğŸ“‚pages
 â”£ ğŸ“‚stores
 â”£ ğŸ“‚styles
 â”£ ğŸ“‚types
```

## ê¸°ëŠ¥ ì„¤ëª…

**1. ê²€ìƒ‰ì°½ ì»´í¬ë„ŒíŠ¸ ì„¤ê³„**
  - MainPage.tsx
    - ì•„ë˜ì—ì„œ ì„¤ëª…í•  SearchInputê³¼ SearchResultsë¥¼ í¬í•¨í•˜ê³  ìˆëŠ” í˜ì´ì§€ì´ë‹¤.
    - í•´ë‹¹ í˜ì´ì§€ì—ì„œ ìµœê·¼ ê²€ìƒ‰ì–´ ìºì‹œë¥¼ í™•ì¸í•˜ë©°, ë””ë°”ìš´ìŠ¤ë¥¼ ì‚¬ìš©í•´ ê²°ê³¼ê°’ì„ í˜¸ì¶œí•œë‹¤.
  - SearchInput.tsx
    - ì‚¬ìš©ìì˜ ì…ë ¥ê°’ì„ valueì— ì €ì¥ì‹œí‚¨ë‹¤.
    - í‚¤ë³´ë“œì˜ â†‘, â†“, enterë¥¼ í†µí•´ ê²°ê³¼ê°’ì„ ì´ë™í•˜ë©´ì„œ ì„ íƒí•œë‹¤.
  - SearchButton.tsx
    - SearchInputì˜ í•˜ìœ„ button ì»´í¬ë„ŒíŠ¸ì´ë‹¤.
    - 'ìµœê·¼ ê²€ìƒ‰ì–´'ì— ì €ì¥ë  ìˆ˜ ìˆë„ë¡ í•˜ë©°, valueê°’ì„ ì´ˆê¸°í™” ì‹œí‚¨ë‹¤.
  - SearchResults.tsx
    - 'ì¶”ì²œ ê²€ìƒ‰ì–´'ì™€ 'ìµœê·¼ ê²€ìƒ‰ì–´'ë¥¼ í™•ì¸í•  ìˆ˜ ìˆëŠ” div ì»´í¬ë„ŒíŠ¸ì´ë‹¤.
    - ìµœëŒ€ 6ê°œì˜ ê²°ê³¼ê°’ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
    - 'ì¶”ì²œ ê²€ìƒ‰ì–´'ê°€ ì—†ë‹¤ë©´ 'ì¶”ì²œ ê²€ìƒ‰ì–´ ì—†ìŒ'ì´ë€ ë¬¸êµ¬ê°€,
      'ìµœê·¼ ê²€ìƒ‰ì–´'ê°€ ì—†ë‹¤ë©´ 'ìµœê·¼ ê²€ìƒ‰ì–´ ì—†ìŒ'ì´ë€ ë¬¸êµ¬ê°€ ëœ¬ë‹¤.
      ë¡œë”©ì¤‘ì´ë¼ë©´ 'Loading...'ì´ë€ ë¬¸êµ¬ê°€ ëœ¬ë‹¤.
   - SearchResult.tsx
     - SearchResultsì˜ í•˜ìœ„ button ì»´í¬ë„ŒíŠ¸ì´ë‹¤.
     - valueë¥¼ Inputì°½ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.

---

**2. Inputì˜ ë§¤ ì…ë ¥ë§ˆë‹¤ APIí˜¸ì¶œì„ ë°©ì§€í•˜ê¸°**   
   
-  "**Debounce** ì‚¬ìš©"
    ```
    const useDebounce = (callback: () => void) => {
      const timer = useRef<ReturnType<typeof setTimeout>>()

      const dispatchDebounce = () => {
        if (timer.current) {
          clearTimeout(timer.current)
        }

        const newTimer = setTimeout(() => {
          callback()
        }, 750)

        timer.current = newTimer
      }

      return dispatchDebounce
    }
    ```

    - 750ms í›„ì— callback í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ë„ë¡ ì‘ì„±í–ˆìŒ.
    - callback í•¨ìˆ˜ë¡œëŠ” ìºì‹œë¥¼ í™•ì¸í•˜ê³ , apië¥¼ í˜¸ì¶œí•˜ëŠ” ì»¤ìŠ¤í…€ í›…ì„ ë„£ìŒ.
- api í˜¸ì¶œ í™•ì¸ì€ interceptorsë¥¼ í†µí•´ êµ¬í˜„
  ```
  API.interceptors.request.use((config) => {
     console.info('calling api')

     return config
  })
  ```

---

3. **API ë¡œì»¬ ìºì‹±**   
   - **ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€** ì‚¬ìš©
   - ìµœê·¼ ê²€ìƒ‰ì–´
     - useRecentStorage ì»¤ìŠ¤í…€ í›… ì œì‘
       ```
       const useRecentStorage = (key: string, value: string) => {
         const saveRecentResults = () => {
           const recentlyKeywords = sessionStorage.getItem(key)

           if (recentlyKeywords) {
             const keywordsSet = new Set(JSON.parse(recentlyKeywords))

             if (value.length !== 0) {
               if (keywordsSet.has(value)) {
                 keywordsSet.delete(value)
               }

               keywordsSet.add(value)
             }
  
             sessionStorage.setItem(key, JSON.stringify(Array.from(keywordsSet)))
           } else {
             const keywordsSet = new Set([value])

             sessionStorage.setItem(key, JSON.stringify(Array.from(keywordsSet)))
           }
         }

         return saveRecentResults
       }

       export default useRecentStorage
       ```
         - keyëŠ” 'recentlyKeywords', valueëŠ” ë¬¸ìì—´ ë°°ì—´ë¡œ SearchButtonì„ ëˆŒë €ì„ ë•Œ inputì˜ valueë¥¼ pushí•´ì¤¬ìŒ.
   - ì¶”ì²œ ê²€ìƒ‰ì–´
     - useRecommendStorage ì»¤ìŠ¤í…€ í›… ì œì‘
       ```
       import { useState } from 'react'

       import { getSicks } from 'apis/sickApi'
       import { Result } from 'types/search'

       const useRecommendStorage = (keyword: string, setResults: (value: Result[]) => void) => {
         const [loading, setLoading] = useState<boolean>(false)

         const checkCache = () => {
           setLoading(true)

           const cache = sessionStorage.getItem(keyword)

           if (cache) {
             const parseCache = JSON.parse(cache)

             if (parseCache.expireTime < new Date().getTime()) {
               sessionStorage.removeItem(keyword)
             } else {
               setResults(JSON.parse(cache).data)
               setLoading(false)
               return
             }
           }

           getSicks(keyword)
             .then((res) => {
               setResults(res.data)
               sessionStorage.setItem(
                 keyword,
                 JSON.stringify({ data: res.data, expireTime: new Date().getTime() + 1000 * 60 })
               )
             })
             .catch((err) => console.error(err))
             .finally(() => setLoading(false))
         }

         return { checkCache, loading }
       }

       export default useRecommendStorage

       ```
         - apië¥¼ í˜¸ì¶œí•˜ê¸° ì „, ìºì‹œê°€ ëœ keywordì¸ì§€ í™•ì¸í•¨.
         - ìºì‹œê°€ ëë‹¤ë©´, í•´ë‹¹ valueë¥¼ resultsë¡œ ì„ ì–¸í•¨.
         - ìºì‹œê°€ ë˜ì§€ ì•Šì•˜ë‹¤ë©´ keyëŠ” keyword, valueëŠ” ê²€ìƒ‰ê°’ìœ¼ë¡œ ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥í•˜ê³ , ê²ìƒ‰ê°’ì„ resultsë¡œ ì„ ì–¸í•¨.

---

4. **ìºì‹±ì˜ Expire Time(stale-time) êµ¬í˜„**
   - ì¶”ì²œ ê²€ìƒ‰ì–´ë¥¼ ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥í•  ë•Œ valueì— expireTimeì„ í¬í•¨ì‹œì¼œ ì €ì¥í•¨.
     ```
     sessionStorage.setItem(
       keyword,
       JSON.stringify({ data: res.data, expireTime: newDate().getTime() + 1000 * 60 })
     )
     ```
   - ìºì‹œê°€ ëëŠ”ì§€ í™•ì¸í•  ë•Œ, expireTimeì„ ì´ˆê³¼í–ˆë‹¤ë©´ í•´ë‹¹ keywordì˜ ì„¸ì…˜ìŠ¤í† ë¦¬ì§€ ê°’ì„ ì‚­ì œí•˜ê³ , ë‹¤ì‹œ api í˜¸ì¶œì„ ì‹¤í–‰í•¨.
     ```
     if (cache) {
        const parseCache = JSON.parse(cache)

        if (parseCache.expireTime < new Date().getTime()) {
           sessionStorage.removeItem(keyword)
        } else {
           ...
        }
     }
     ```
---

5. **í‚¤ë³´ë“œë¡œ ê²€ìƒ‰ê²°ê³¼ ì´ë™**
   - useChangeFocus ì»¤ìŠ¤í…€ í›… ì œì‘
     - focusë˜ê³  ìˆëŠ” ê²°ê³¼ê°’ì˜ ì¸ë±ìŠ¤(=focusIdx)ë¥¼ ë°˜í™˜í•˜ëŠ” í›…
     - â†‘, â†“ : ê²°ê³¼ê°’ ì´ë™
     - Enter : ê²°ê³¼ê°’ ì„ íƒ
     - ESC : ê²°ê³¼ì°½ ë‹«ê¸°

     ```
     const useChangeFocus = (setIsFocus: React.Dispatch<React.SetStateAction<boolean>>) => {
       const { setValue, results, focusIdx, setFocusIdx } = useSearchStore()

       const RESULTS_LENGTH = results.length

       const changeIdxNum = (e: React.KeyboardEvent<HTMLInputElement>) => {
         if (e.key === 'ArrowDown') {
           RESULTS_LENGTH > 0 && RESULTS_LENGTH < RESULTS_MAX_LENGTH
             ? setFocusIdx((focusIdx + 1) % RESULTS_LENGTH)
             : setFocusIdx((focusIdx + 1) % RESULTS_MAX_LENGTH)
         }
         if (e.key === 'ArrowUp') {
           RESULTS_LENGTH > 0 && RESULTS_LENGTH < RESULTS_MAX_LENGTH
             ? setFocusIdx((focusIdx - 1 + RESULTS_LENGTH) % RESULTS_LENGTH)
             : setFocusIdx((focusIdx - 1 + RESULTS_MAX_LENGTH) % RESULTS_MAX_LENGTH)
         }
         if (e.key === 'Escape') {
           setFocusIdx(-1)
           setIsFocus(false)
         }
         if (e.key === 'Enter') {
           RESULTS_LENGTH > 0 && focusIdx >= 0 && setValue(results[focusIdx]['sickNm'])
           setFocusIdx(-1)
         }
       }

       return changeIdxNum
     }
     ```
   - focusê°€ ë˜ê³  ìˆë‹¤ë©´ ë°°ê²½ìƒ‰ì„ hoverì¼ ë•Œì™€ ë™ì¼í•  ìˆ˜ ìˆë„ë¡ ì‘ì„±í•¨.
     ```
     ${({ $isResultFocus }) => $isResultFocus && `background-color: #f9f7f2`}
     ```

## ì‹¤í–‰ ê²°ê³¼ ì˜ìƒ

2. Inputì˜ ë§¤ ì…ë ¥ë§ˆë‹¤ APIí˜¸ì¶œì„ ë°©ì§€í•˜ê¸°   
https://github.com/wisdomin121/wanted-pre-onboarding-frontend-3/assets/46989954/b96102fc-2245-4ad4-b9f6-ba1480041bea


3. API ë¡œì»¬ ìºì‹± / 4. ìºì‹±ì˜ Expire Time(stale-time) êµ¬í˜„   
https://github.com/wisdomin121/wanted-pre-onboarding-frontend-3/assets/46989954/ac3c5d40-525c-4ec6-a35e-817fbf2a7a98

5. í‚¤ë³´ë“œë¡œ ê²€ìƒ‰ê²°ê³¼ ì´ë™   
https://github.com/wisdomin121/wanted-pre-onboarding-frontend-3/assets/46989954/290491f8-c68d-43e7-ae47-edac2df0e86e
